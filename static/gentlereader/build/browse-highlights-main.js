define("utils/globals",[],function(){var t;return t={},{getGlobals:function(){return t}}}),define("routers/browse-highlights-router",["backbone","utils/globals"],function(t,e){var s;return e=e.getGlobals(),s=t.Router.extend({initialize:function(){return t.history.start({silent:!0})},routes:{":author":"selectAuthor","":"getRandom"},selectAuthor:function(t){return e.app.getHighlights(t)},getRandom:function(){return e.app.getRandom()}})}),require.config({paths:{jade:"/static/gentlereader/scripts/lib/jade-runtime"},shim:{jade:{exports:"jade"}}}),define("templates/brQuotRandomTempl",["jade"],function(jade){function brQuotRandomTempl(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push('\n<h2 class="hl-random-h">A Few at Random</h2>'),function(){if("number"==typeof locals.length)for(var t=0,e=locals.length;e>t;t++){var s=locals[t];buf.push('\n<section class="hl-sel-block">\n  <h3 class="hl-subhead"><span class="header-from">from&nbsp;</span><a'),buf.push(attrs({href:"/selections/"+s.selection.slug},{href:!0})),buf.push(">&ldquo;"+escape(null==(interp=s.selection.title)?"":interp));var n=s.selection.title;"?&rdquo;"!=n.charAt(n.length-1)&&buf.push(",&rdquo;"),buf.push("&nbsp;by "+escape(null==(interp=s.selection.author)?"":interp)+'&nbsp;<span class="hl-sel-dates">('+escape(null==(interp=s.selection.pub_year)?"":interp)+')</span></a></h3>\n  <ul>\n    <li class="hl-i">\n      <div class="hl-quotationmark">&#8220;</div><a'),buf.push(attrs({href:"/highlights/"+s.quotation.id,"class":"hl-quote hl-random"},{href:!0})),buf.push(">");var a=s.quotation.quotation;buf.push(null==a?"":a),buf.push('</a>\n    </li>\n  </ul>\n  <div class="hl-more"><a'),buf.push(attrs({href:"/selections/"+s.selection.slug,"class":"hl-more--link"},{href:!0})),buf.push(">read this full selection &raquo;</a><br/><a"),buf.push(attrs({href:"/highlights/#"+s.selection.author_slug,"class":"hl-more--link"},{href:!0})),buf.push(">+ more highlights from "+escape(null==(interp=s.selection.author)?"":interp)+"</a></div>\n</section>")}else{var e=0;for(var t in locals){e++;var s=locals[t];buf.push('\n<section class="hl-sel-block">\n  <h3 class="hl-subhead"><span class="header-from">from&nbsp;</span><a'),buf.push(attrs({href:"/selections/"+s.selection.slug},{href:!0})),buf.push(">&ldquo;"+escape(null==(interp=s.selection.title)?"":interp));var n=s.selection.title;"?&rdquo;"!=n.charAt(n.length-1)&&buf.push(",&rdquo;"),buf.push("&nbsp;by "+escape(null==(interp=s.selection.author)?"":interp)+'&nbsp;<span class="hl-sel-dates">('+escape(null==(interp=s.selection.pub_year)?"":interp)+')</span></a></h3>\n  <ul>\n    <li class="hl-i">\n      <div class="hl-quotationmark">&#8220;</div><a'),buf.push(attrs({href:"/highlights/"+s.quotation.id,"class":"hl-quote hl-random"},{href:!0})),buf.push(">");var a=s.quotation.quotation;buf.push(null==a?"":a),buf.push('</a>\n    </li>\n  </ul>\n  <div class="hl-more"><a'),buf.push(attrs({href:"/selections/"+s.selection.slug,"class":"hl-more--link"},{href:!0})),buf.push(">read this full selection &raquo;</a><br/><a"),buf.push(attrs({href:"/highlights/#"+s.selection.author_slug,"class":"hl-more--link"},{href:!0})),buf.push(">+ more highlights from "+escape(null==(interp=s.selection.author)?"":interp)+"</a></div>\n</section>")}}}.call(this)}return buf.join("")}return brQuotRandomTempl}),require.config({paths:{jade:"/static/gentlereader/scripts/lib/jade-runtime"},shim:{jade:{exports:"jade"}}}),define("templates/brQuotAuthTempl",["jade"],function(jade){function brQuotAuthTempl(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push('\n<h2 id="highlight-author" class="highlight-author-h"><span class="header-from">from&nbsp;</span><a'),buf.push(attrs({href:"/authors/"+author.slug},{href:!0})),buf.push(">");var __val__=author.full_name;buf.push(escape(null==__val__?"":__val__)),buf.push("</a></h2>"),function(){if("number"==typeof selections.length)for(var t=0,e=selections.length;e>t;t++){var s=selections[t];buf.push('\n<section class="hl-sel-block">\n  <h3 class="hl-subhead"><a'),buf.push(attrs({href:"/selections/"+s.slug},{href:!0})),buf.push(">&ldquo;"+escape(null==(interp=s.title)?"":interp)+'&rdquo;&nbsp;<span class="sel-dates">('+escape(null==(interp=s.date_display)?"":interp)+")</span></a></h3>\n  <ul"),buf.push(attrs({"data-sel":""+s.id},{"data-sel":!0})),buf.push(">"),function(){if("number"==typeof s.quotations.length)for(var t=0,e=s.quotations.length;e>t;t++){var n=s.quotations[t];buf.push('\n    <li class="hl-i"><span class="hl-quotationmark">&#8220;</span><a'),buf.push(attrs({href:"/highlights/"+n.id,"class":"hl-quote"},{href:!0})),buf.push(">");var a=n.quotation;buf.push(null==a?"":a),buf.push("</a></li>")}else{var e=0;for(var t in s.quotations){e++;var n=s.quotations[t];buf.push('\n    <li class="hl-i"><span class="hl-quotationmark">&#8220;</span><a'),buf.push(attrs({href:"/highlights/"+n.id,"class":"hl-quote"},{href:!0})),buf.push(">");var a=n.quotation;buf.push(null==a?"":a),buf.push("</a></li>")}}}.call(this),buf.push('\n  </ul>\n  <div class="hl-more">\n    <div><a'),buf.push(attrs({href:"/selections/"+s.slug},{href:!0})),buf.push(">read this full selection &raquo;</a></div>\n  </div>\n</section>")}else{var e=0;for(var t in selections){e++;var s=selections[t];buf.push('\n<section class="hl-sel-block">\n  <h3 class="hl-subhead"><a'),buf.push(attrs({href:"/selections/"+s.slug},{href:!0})),buf.push(">&ldquo;"+escape(null==(interp=s.title)?"":interp)+'&rdquo;&nbsp;<span class="sel-dates">('+escape(null==(interp=s.date_display)?"":interp)+")</span></a></h3>\n  <ul"),buf.push(attrs({"data-sel":""+s.id},{"data-sel":!0})),buf.push(">"),function(){if("number"==typeof s.quotations.length)for(var t=0,e=s.quotations.length;e>t;t++){var n=s.quotations[t];buf.push('\n    <li class="hl-i"><span class="hl-quotationmark">&#8220;</span><a'),buf.push(attrs({href:"/highlights/"+n.id,"class":"hl-quote"},{href:!0})),buf.push(">");var a=n.quotation;buf.push(null==a?"":a),buf.push("</a></li>")}else{var e=0;for(var t in s.quotations){e++;var n=s.quotations[t];buf.push('\n    <li class="hl-i"><span class="hl-quotationmark">&#8220;</span><a'),buf.push(attrs({href:"/highlights/"+n.id,"class":"hl-quote"},{href:!0})),buf.push(">");var a=n.quotation;buf.push(null==a?"":a),buf.push("</a></li>")}}}.call(this),buf.push('\n  </ul>\n  <div class="hl-more">\n    <div><a'),buf.push(attrs({href:"/selections/"+s.slug},{href:!0})),buf.push(">read this full selection &raquo;</a></div>\n  </div>\n</section>")}}}.call(this)}return buf.join("")}return brQuotAuthTempl}),define("apps/browse-highlights-app",["backbone","routers/browse-highlights-router","templates/brQuotRandomTempl","templates/brQuotAuthTempl","lib/matchMedia","utils/isElementInViewport"],function(t,e,s,n,a,r){var i,u;return u=$("#browseHighlights"),i=t.View.extend({initialize:function(){return this.router=new e,this.setRandomizers(),this.setAuthorSelect(),t.history.fragment?this.initialRouting():this.getRandom()},setRandomizers:function(){var t=this;return $(".random-highlights").click(function(){return t.router.navigate("/",{trigger:!1}),t.getRandom()})},setAuthorSelect:function(){var t,e=this;return t=$("#selectHighlightAuthor"),t.change(function(){return e.router.navigate(t.val(),{trigger:!0})})},initialRouting:function(){"If there is a url fragment, route right away to get\nauthor-specific highlights.";return this.getHighlights(t.history.fragment)},getRandom:function(){var t,e,n=this;return t=3,e={dataType:"json",url:"/api/quotations/random?quantity="+t,error:function(){return console.log("Failure getting random highlights.")},success:function(t){return n.render(t,s)}},$.ajax(e)},getHighlights:function(t){var e,s=this;return e={dataType:"json",url:"/api/authors/"+t+"/quotations",error:function(){return console.log("Failure getting author highlights.")},success:function(t){return s.render(t,n,"highlight-author")}},$.ajax(e)},render:function(t,e,s){var n;return n=e(t),u.fadeOut(function(){return u.html(n).fadeIn(function(){var t;return s&&!r(document.getElementById(s))?(t=a("screen and (min-width: 760px)").matches?55:0,$("html, body").animate({scrollTop:$("#"+s).offset().top-t},"fast")):void 0})})}})}),require(["utils/globals","apps/rand-quot-app","apps/browse-highlights-app"],function(t,e,s){var n,a;return t=t.getGlobals(),a=new e,n=t.app=new s,$("#bhaLabel").click(function(t){return t.preventDefault(),$("#selectHighlightAuthor").click()})}),define("browse-highlights-main",function(){});