define("utils/globals",[],function(){var e;return e={},{getGlobals:function(){return e}}}),define("routers/browse-highlights-router",["backbone","utils/globals"],function(e,i){var a;return i=i.getGlobals(),a=e.Router.extend({initialize:function(){return e.history.start({silent:!0})},routes:{":author":"selectAuthor","":"getRandom"},selectAuthor:function(e){return i.app.getHighlights(e)},getRandom:function(){return i.app.getRandom()}})}),require.config({paths:{jade:"/static/gentlereader/scripts/lib/jade-runtime"},shim:{jade:{exports:"jade"}}}),define("templates/brQuotRandomTempl",["jade"],function(jade){function brQuotRandomTempl(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;!function(){if("number"==typeof locals.length)for(var e=0,i=locals.length;i>e;e++){var a=locals[e];buf.push('\n<section class="sel-block">\n  <h3 class="hl-subhead"><span class="header-from">from&nbsp;</span><a'),buf.push(attrs({href:"/selections/"+a.selection.slug},{href:!0})),buf.push(">&ldquo;"+escape(null==(interp=a.selection.title)?"":interp));var t=a.selection.title;"?&rdquo;"!=t.charAt(t.length-1)&&buf.push(",&rdquo;"),buf.push("&nbsp;by "+escape(null==(interp=a.selection.author)?"":interp)+'&nbsp;<span class="sel-dates">('+escape(null==(interp=a.selection.pub_year)?"":interp)+')</span></a></h3>\n  <ul class="quotation-list">\n    <li class="quotation-list-item"><span class="quotation-marker">&#8220;</span><a'),buf.push(attrs({href:"/highlights/"+a.quotation.id,"class":"quotation-text random-quot"},{href:!0})),buf.push(">");var r=a.quotation.quotation;buf.push(null==r?"":r),buf.push('</a></li>\n  </ul>\n  <div class="read-more"><a'),buf.push(attrs({href:"/selections/"+a.selection.slug},{href:!0})),buf.push(">read this full selection &raquo;</a><br/><a"),buf.push(attrs({href:"/highlights/#"+a.selection.author_slug},{href:!0})),buf.push(">+ more highlights from "+escape(null==(interp=a.selection.author)?"":interp)+"</a></div>\n</section>")}else{var i=0;for(var e in locals){i++;var a=locals[e];buf.push('\n<section class="sel-block">\n  <h3 class="hl-subhead"><span class="header-from">from&nbsp;</span><a'),buf.push(attrs({href:"/selections/"+a.selection.slug},{href:!0})),buf.push(">&ldquo;"+escape(null==(interp=a.selection.title)?"":interp));var t=a.selection.title;"?&rdquo;"!=t.charAt(t.length-1)&&buf.push(",&rdquo;"),buf.push("&nbsp;by "+escape(null==(interp=a.selection.author)?"":interp)+'&nbsp;<span class="sel-dates">('+escape(null==(interp=a.selection.pub_year)?"":interp)+')</span></a></h3>\n  <ul class="quotation-list">\n    <li class="quotation-list-item"><span class="quotation-marker">&#8220;</span><a'),buf.push(attrs({href:"/highlights/"+a.quotation.id,"class":"quotation-text random-quot"},{href:!0})),buf.push(">");var r=a.quotation.quotation;buf.push(null==r?"":r),buf.push('</a></li>\n  </ul>\n  <div class="read-more"><a'),buf.push(attrs({href:"/selections/"+a.selection.slug},{href:!0})),buf.push(">read this full selection &raquo;</a><br/><a"),buf.push(attrs({href:"/highlights/#"+a.selection.author_slug},{href:!0})),buf.push(">+ more highlights from "+escape(null==(interp=a.selection.author)?"":interp)+"</a></div>\n</section>")}}}.call(this)}return buf.join("")}return brQuotRandomTempl}),require.config({paths:{jade:"/static/gentlereader/scripts/lib/jade-runtime"},shim:{jade:{exports:"jade"}}}),define("templates/brQuotAuthTempl",["jade"],function(jade){function brQuotAuthTempl(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push('\n<h2 id="highlight-author" class="highlight-author-h"><span class="header-from">from&nbsp;</span><a'),buf.push(attrs({href:"/authors/"+author.slug},{href:!0})),buf.push(">");var __val__=author.full_name;buf.push(escape(null==__val__?"":__val__)),buf.push("</a></h2>"),function(){if("number"==typeof selections.length)for(var e=0,i=selections.length;i>e;e++){var a=selections[e];buf.push('\n<section class="sel-block">\n  <h3 class="hl-subhead"><a'),buf.push(attrs({href:"/selections/"+a.slug},{href:!0})),buf.push(">&ldquo;"+escape(null==(interp=a.title)?"":interp)+'&rdquo;&nbsp;<span class="sel-dates">('+escape(null==(interp=a.date_display)?"":interp)+")</span></a></h3>\n  <ul"),buf.push(attrs({"data-sel":""+a.id,"class":"quotation-list"},{"data-sel":!0})),buf.push(">"),function(){if("number"==typeof a.quotations.length)for(var e=0,i=a.quotations.length;i>e;e++){var t=a.quotations[e];buf.push('\n    <li class="quotation-list-item"><span class="quotation-marker">&#8220;</span><a'),buf.push(attrs({href:"/highlights/"+t.id,"class":"quotation-text"},{href:!0})),buf.push(">");var r=t.quotation;buf.push(null==r?"":r),buf.push("</a></li>")}else{var i=0;for(var e in a.quotations){i++;var t=a.quotations[e];buf.push('\n    <li class="quotation-list-item"><span class="quotation-marker">&#8220;</span><a'),buf.push(attrs({href:"/highlights/"+t.id,"class":"quotation-text"},{href:!0})),buf.push(">");var r=t.quotation;buf.push(null==r?"":r),buf.push("</a></li>")}}}.call(this),buf.push('\n  </ul>\n  <div class="read-more">\n    <div><a'),buf.push(attrs({href:"/selections/"+a.slug},{href:!0})),buf.push(">read this full selection &raquo;</a></div>\n  </div>\n</section>")}else{var i=0;for(var e in selections){i++;var a=selections[e];buf.push('\n<section class="sel-block">\n  <h3 class="hl-subhead"><a'),buf.push(attrs({href:"/selections/"+a.slug},{href:!0})),buf.push(">&ldquo;"+escape(null==(interp=a.title)?"":interp)+'&rdquo;&nbsp;<span class="sel-dates">('+escape(null==(interp=a.date_display)?"":interp)+")</span></a></h3>\n  <ul"),buf.push(attrs({"data-sel":""+a.id,"class":"quotation-list"},{"data-sel":!0})),buf.push(">"),function(){if("number"==typeof a.quotations.length)for(var e=0,i=a.quotations.length;i>e;e++){var t=a.quotations[e];buf.push('\n    <li class="quotation-list-item"><span class="quotation-marker">&#8220;</span><a'),buf.push(attrs({href:"/highlights/"+t.id,"class":"quotation-text"},{href:!0})),buf.push(">");var r=t.quotation;buf.push(null==r?"":r),buf.push("</a></li>")}else{var i=0;for(var e in a.quotations){i++;var t=a.quotations[e];buf.push('\n    <li class="quotation-list-item"><span class="quotation-marker">&#8220;</span><a'),buf.push(attrs({href:"/highlights/"+t.id,"class":"quotation-text"},{href:!0})),buf.push(">");var r=t.quotation;buf.push(null==r?"":r),buf.push("</a></li>")}}}.call(this),buf.push('\n  </ul>\n  <div class="read-more">\n    <div><a'),buf.push(attrs({href:"/selections/"+a.slug},{href:!0})),buf.push(">read this full selection &raquo;</a></div>\n  </div>\n</section>")}}}.call(this)}return buf.join("")}return brQuotAuthTempl}),define("apps/browse-highlights-app",["backbone","routers/browse-highlights-router","templates/brQuotRandomTempl","templates/brQuotAuthTempl","lib/matchMedia","utils/isElementInViewport"],function(e,i,a,t,r,o){var n,s;return s=$("#highlight-container"),n=e.View.extend({initialize:function(){return this.router=new i,this.setRandomizers(),this.setAuthorSelect(),e.history.fragment?this.initialRouting():this.getRandom()},setRandomizers:function(){var e=this;return $(".random-highlights").click(function(){return e.router.navigate("/",{trigger:!1}),e.getRandom()})},setAuthorSelect:function(){var e,i=this;return e=$("#select-highlight-author"),e.change(function(){return i.router.navigate(e.val(),{trigger:!0})})},initialRouting:function(){"If there is a url fragment, route right away to get\nauthor-specific highlights.";return this.getHighlights(e.history.fragment)},getRandom:function(){var e,i,t=this;return e=3,i={dataType:"json",url:"/api/quotations/random?quantity="+e,error:function(){return console.log("Failure getting random highlights.")},success:function(e){return t.render(e,a)}},$.ajax(i)},getHighlights:function(e){var i,a=this;return i={dataType:"json",url:"/api/authors/"+e+"/quotations",error:function(){return console.log("Failure getting author highlights.")},success:function(e){return a.render(e,t,"highlight-author")}},$.ajax(i)},render:function(e,i,a){var t;return t=i(e),s.fadeOut(function(){return s.html(t).fadeIn(function(){var e;return a&&!o(document.getElementById(a))?(e=r("screen and (min-width: 760px)").matches?55:0,$("html, body").animate({scrollTop:$("#"+a).offset().top-e},"fast")):void 0})})}})}),require(["utils/globals","apps/rand-quot-app","apps/browse-highlights-app"],function(e,i,a){var t,r;return e=e.getGlobals(),r=new i,t=e.app=new a}),define("browse-highlights-main",function(){});